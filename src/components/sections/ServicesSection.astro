---
import Image from "astro/components/Image.astro";
import { ArrowRightIcon } from "../icons";
import { services } from "../../data/services";

const baseUrl = (import.meta.env.BASE_URL || "/").replace(/\/?$/, "/");
const hizmetlerPageUrl = `${baseUrl}hizmetler`;
---

<section id="hizmetlerimiz" class="w-full bg-white py-20 px-6">
  <div class="max-w-[1440px] mx-auto">
    <div class="flex flex-col sm:flex-row sm:items-end sm:justify-between gap-6 mb-12 md:mb-20">
      <div class="text-center sm:text-left">
        <p class="text-[#E30A17] text-sm font-bold mb-4 tracking-wider uppercase">
          HİZMETLERİMİZ
        </p>
        <h2 class="text-[#262322] text-4xl md:text-5xl font-semibold leading-tight">
          Danışanlarımıza Neler Sunuyoruz?
        </h2>
      </div>
      <a
        href={hizmetlerPageUrl}
        class="inline-flex items-center justify-center gap-2 rounded-full bg-[#E30A17] pl-2 pr-6 py-3 text-base font-medium text-white hover:bg-[#c00914] transition-colors w-fit shrink-0 mx-auto sm:mx-0"
      >
        <div class="w-10 h-10 rounded-full bg-white flex items-center justify-center shrink-0">
          <ArrowRightIcon color="#E30A17" />
        </div>
        Daha fazla
      </a>
    </div>

    <div class="overflow-x-auto overflow-y-auto  scrollbar-hide -mx-6 px-6 md:mx-0 md:px-0 max-h-[350px] md:max-h-[800px] py-16">
      <div class="flex-col flex-nowrap md:flex gap-8 md:gap-12 w-max md:w-full">
        {services.map((service, index) => (
<div class="group flex flex-col md:flex-row md:items-center md:justify-between gap-4 md:gap-4 px-4 md:px-12 lg:px-[72px] py-6 rounded-3xl hover:bg-[#E30A17] hover:py-8 md:hover:py-16 transition-all duration-400 relative w-[400px] sm:w-[620px] md:w-[820px]  lg:min-w-full  shrink-0 md:shrink">

    <div class="flex items-start gap-2 md:gap-4 md:w-[25%]">
        <p class="text-[#E30A17] group-hover:text-white text-2xl md:text-3xl lg:text-4xl font-semibold leading-none transition-colors duration-300 shrink-0">{service.number}.</p>
        <p class="text-[#262322] group-hover:text-white text-lg md:text-xl lg:text-2xl font-semibold leading-tight transition-colors duration-300">{service.title}</p>
    </div>
    <Image src={`${baseUrl}${service.image}`} alt={service.title} width={50} height={50} class="w-[40%] md:w-[30%] absolute scale-0 group-hover:scale-100 transition-all duration-300 top-[50%] left-[50%] md:left-[46%] transform -translate-x-1/2 -translate-y-1/2 rotate-0 group-hover:-rotate-12 hidden md:block" />
        <p class="text-[#585858] group-hover:text-white text-sm md:text-base lg:text-lg leading-relaxed w-full md:w-1/3">{service.description}</p>
</div>
        ))}
      </div>
    </div>
  </div>
</section>

<script>
  function initServices() {
    const serviceItems = document.querySelectorAll('.service-item');
    
    serviceItems.forEach((item) => {
      const defaultContent = item.querySelector('.service-content-default');
      const activeContent = item.querySelector('.service-content-active');
      const imageContainer = item.querySelector('.service-image-container');
      
      if (!defaultContent || !activeContent || !imageContainer) return;

      item.addEventListener('click', () => {
        const isActive = activeContent.classList.contains('active');
        
        serviceItems.forEach((otherItem) => {
          if (otherItem !== item) {
            const otherDefault = otherItem.querySelector('.service-content-default');
            const otherActive = otherItem.querySelector('.service-content-active');
            const otherImageContainer = otherItem.querySelector('.service-image-container');
            if (otherDefault && otherActive && otherImageContainer) {
              otherDefault.classList.remove('hidden');
              otherActive.classList.remove('active');
              otherImageContainer.classList.remove('active');
            }
          }
        });

        if (isActive) {
          defaultContent.classList.remove('hidden');
          activeContent.classList.remove('active');
          imageContainer.classList.remove('active');
        } else {
          defaultContent.classList.add('hidden');
          activeContent.classList.add('active');
          imageContainer.classList.add('active');
        }
      });
    });
  }

  if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', initServices);
  } else {
    initServices();
  }
</script>

<style>
  .service-item {
    position: relative;
    min-height: 200px;
  }

  .service-content-default {
    position: relative;
    z-index: 1;
  }

  .service-content-active {
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    z-index: 2;
  }

  .service-content-active.active {
    opacity: 1;
    pointer-events: auto;
  }

  .scrollbar-hide {
    scrollbar-width: none; /* Firefox */
    -ms-overflow-style: none; /* IE and Edge */
  }

  .scrollbar-hide::-webkit-scrollbar {
    display: none; /* Chrome, Safari, Opera */
  }

  .scrollbar-hide {
    scroll-behavior: smooth;
  }

</style>

